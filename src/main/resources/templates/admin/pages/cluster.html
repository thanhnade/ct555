<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:replace="admin/layout :: layout(~{::content})">
  <div th:fragment="content">
    <div class="page-title-row">
      <div>
        <div class="page-title">ğŸ§© Quáº£n lÃ½ Cluster</div>
      </div>
      <div style="display: flex; gap: 8px; align-items: center;">
        <button class="btn btn-info" id="toggle-notes-btn" onclick="toggleClusterNotes()" title="Xem lÆ°u Ã½">
          <span id="notes-icon">ğŸ“</span> LÆ°u Ã½
        </button>
        <button class="btn" id="refresh-clusters-btn">ğŸ”„ LÃ m má»›i</button>
      </div>
    </div>

    <!-- Notes Section - Hidden by default -->
    <div class="table-card" id="cluster-notes-section" style="margin-bottom: 20px; background: #F0F7FF; border-left: 4px solid #0066CC; display: none;">
      <div style="padding: 16px;">
        <div style="display: flex; align-items: flex-start; gap: 12px; position: relative;">
          <button onclick="toggleClusterNotes()" style="position: absolute; top: 0; right: 0; background: transparent; border: none; font-size: 20px; cursor: pointer; color: #666; padding: 4px 8px;" title="ÄÃ³ng">âœ•</button>
          <span style="font-size: 20px; flex-shrink: 0;">ğŸ“</span>
          <div style="flex: 1; padding-right: 32px;">
            <strong style="color: #003366; font-size: 14px; display: block; margin-bottom: 8px;">LÆ°u Ã½ vá» Cluster Management</strong>
            <ul style="margin: 0; padding-left: 20px; color: #004080; line-height: 1.8; font-size: 13px;">
              <li><strong>Há»‡ thá»‘ng chá»‰ há»— trá»£ 1 cluster duy nháº¥t:</strong> Táº¥t cáº£ servers cÃ³ <code>clusterStatus = "AVAILABLE"</code> sáº½ thuá»™c cluster nÃ y</li>
              <li><strong>ThÃªm server vÃ o cluster:</strong> Sá»­ dá»¥ng trang <a href="/admin/cluster/assign" style="color: #0066CC; text-decoration: underline; font-weight: 600;">GÃ¡n Servers</a> Ä‘á»ƒ set <code>clusterStatus = "AVAILABLE"</code></li>
              <li><strong>Role cá»§a server:</strong> MASTER (control plane) hoáº·c WORKER (worker node) - cáº§n Ã­t nháº¥t 1 MASTER Ä‘á»ƒ cluster hoáº¡t Ä‘á»™ng</li>
              <li><strong>Connection Status:</strong> Äáº£m báº£o servers Ä‘ang CONNECTED hoáº·c ONLINE trÆ°á»›c khi thá»±c hiá»‡n cÃ¡c thao tÃ¡c cluster</li>
              <li><strong>CÃ i Ä‘áº·t Kubernetes:</strong> Sá»­ dá»¥ng <a href="/admin/cluster/setup" style="color: #0066CC; text-decoration: underline; font-weight: 600;">Cluster Setup</a> Ä‘á»ƒ cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Kubernetes trÃªn cluster</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Cluster Summary (includes servers list) -->
    <div class="table-card" id="cluster-summary" style="margin-bottom: 20px;">
      <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
        <div>
          <div class="page-title" style="font-size: 16px; margin-bottom: 8px;">ğŸ“Š ThÃ´ng tin Cluster</div>
        </div>
      </div>
      <div id="cluster-summary-content" style="padding: 16px; background: #F9F9F9; border-radius: 8px; margin-bottom: 20px;">
        <div class="text-center" style="color: #666666;">Äang táº£i...</div>
      </div>
      
      <!-- Servers in Cluster Grid -->
      <div style="margin-top: 20px;">
        <div style="margin-bottom: 12px;">
          <div class="page-title" style="font-size: 14px; margin-bottom: 4px;">ğŸ–¥ Danh sÃ¡ch Servers trong Cluster</div>
          <div class="page-subtitle" style="font-size: 11px; color: #666;">CÃ¡c server cÃ³ <code>clusterStatus = "AVAILABLE"</code> thuá»™c cluster duy nháº¥t.</div>
        </div>
        <div class="servers-grid-container mt-3">
          <div id="cluster-servers-grid" class="row g-3">
            <div class="col-12 text-center text-muted p-4">Äang táº£i...</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="/js/modules/k8sClusters.js"></script>
<script>
  // Toggle cluster notes visibility
  function toggleClusterNotes() {
    const notesSection = document.getElementById('cluster-notes-section');
    const notesIcon = document.getElementById('notes-icon');
    if (notesSection) {
      const isVisible = notesSection.style.display !== 'none';
      if (isVisible) {
        notesSection.style.display = 'none';
        if (notesIcon) notesIcon.textContent = 'ğŸ“';
      } else {
        notesSection.style.display = 'block';
        if (notesIcon) notesIcon.textContent = 'ğŸ“Œ';
        // Smooth scroll to notes
        notesSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
    }
  }
</script>
</body>
</html>
